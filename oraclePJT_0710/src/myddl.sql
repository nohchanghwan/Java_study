
--1번

CREATE TABLE CUSTOMERS(
		CNO		NUMBER(5) PRIMARY KEY,
		CNAME	VARCHAR2(10) NOT NULL,
		ADDRESS	VARCHAR2(50) NOT NULL,
		EMAIL	VARCHAR2(20) NOT NULL,
		PHONE	VARCHAR2(20) NOT NULL
);
	
CREATE TABLE ORDERS(
		ORDERNO		NUMBER(10) PRIMARY KEY,
		ORDERDATE	DATE DEFAULT SYSDATE NOT NULL,
		ADDRESS		VARCHAR2(50) NOT NULL,
		PHONE		VARCHAR2(20) NOT NULL,
		STATUS		VARCHAR2(20) CHECK(STATUS IN('결제완료','배송중','배송완료')) NOT NULL ,
		CNO			NUMBER(5)	 REFERENCES CUSTOMERS(CNO) NOT NULL
);

CREATE TABLE PRODUCTS(
		PNO		NUMBER(5) PRIMARY KEY,
		PNAME	VARCHAR2(20) NOT NULL,
		COST	NUMBER(8) DEFAULT 0 NOT NULL,
		STOCK	NUMBER(5) DEFAULT 0 NOT NULL
);

CREATE TABLE ORDERDETAIL(
		ORDERNO	NUMBER(10) REFERENCES ORDERS(ORDERNO),
		PNO		NUMBER(5) REFERENCES PRODUCTS(PNO),
		QTY		NUMBER(5) DEFAULT 0,
		COST	NUMBER(8) DEFAULT 0,
		PRIMARY KEY(ORDERNO,PNO)
);

--2번

INSERT INTO PRODUCTS VALUES (1001,'삼양라면',1000,200);
INSERT INTO PRODUCTS VALUES (1002,'새우깡',1500,500);
INSERT INTO PRODUCTS VALUES (1003,'월드콘',2000,350);
INSERT INTO PRODUCTS VALUES (1004,'빼빼로',2000,700);
INSERT INTO PRODUCTS VALUES (1005,'코카콜라',1800,550);
INSERT INTO PRODUCTS VALUES (1006,'환타',1600,300);

SELECT *
FROM PRODUCTS

--3

INSERT INTO CUSTOMERS VALUES (101,'김철수','서울 강남구','cskim@naver.com','899-6666');
INSERT INTO CUSTOMERS VALUES (102,'이영희','부산 서면','yhlee@empal.com','355-8882');
INSERT INTO CUSTOMERS VALUES (103,'최진국','제주 동광양','jkchoi@gmail.com','852-5764');
INSERT INTO CUSTOMERS VALUES (104,'강준호','강릉 홍제동','jhkang@hanmail.com','559-7777');
INSERT INTO CUSTOMERS VALUES (105,'민병국','대전 전민동','bgmin@hotmail.com','559-8741');
INSERT INTO CUSTOMERS VALUES (106,'오민수','광주 북구','msoh@microsoft.com','542-9988');


SELECT *
FROM ORDERS

--4

INSERT INTO ORDERS VALUES (1,SYSDATE,'서울 강남구','899-6666','결제완료',101);
INSERT INTO ORDERDETAIL VALUES (1,1001,50,1000);

SELECT *
FROM ORDERDETAIL

--5

UPDATE PRODUCTS
SET STOCK = 150
WHERE	PNO = 1001 ;

SELECT *
FROM PRODUCTS

--6

INSERT INTO ORDERS VALUES (2,SYSDATE,'부산 수영구','337-5000','결제완료',102);
INSERT INTO ORDERDETAIL VALUES (2,1002,100,1500);
INSERT INTO ORDERDETAIL VALUES (2,1003,150,2000);


--7

UPDATE PRODUCTS
SET STOCK = 400
WHERE	PNO = 1002 ;

UPDATE PRODUCTS
SET STOCK = 200
WHERE	PNO = 1003 ;

SELECT *
FROM PRODUCTS


--8

INSERT INTO ORDERS VALUES (3,SYSDATE,'광주 북구','652-2277','결제완료',106);
INSERT INTO ORDERDETAIL VALUES (3,1004,100,2000);
INSERT INTO ORDERDETAIL VALUES (3,1005,50,1800);


--9

UPDATE PRODUCTS
SET STOCK = 600
WHERE	PNO = 1004 ;

UPDATE PRODUCTS
SET STOCK = 500
WHERE	PNO = 1005 ;

SELECT *
FROM PRODUCTS


--10

SELECT 	O.ORDERDATE,C.CNAME, O.ADDRESS,O.PHONE,O.STATUS,P.PNAME, D.COST , D.QTY ,D.COST*D.QTY AS "COST*QTY"
FROM 	ORDERDETAIL D 
JOIN	PRODUCTS P ON(P.PNO = D.PNO)
JOIN	ORDERS O ON(D.ORDERNO = O.ORDERNO)
JOIN	CUSTOMERS C ON(O.CNO = C.CNO);


--11

SELECT 	O.ORDERDATE , SUM(COST*QTY)
FROM 	ORDERDETAIL D
JOIN	ORDERS	O ON(D.ORDERNO = O.ORDERNO)
GROUP BY O.ORDERDATE;

--12


INSERT INTO PRODUCTS VALUES (1007,'목캔티',3000,500);

--13

INSERT INTO ORDERS VALUES (4,SYSDATE,'제주 동광양','352-4657','결제완료',103);
INSERT INTO ORDERDETAIL VALUES (4,1007,200,3000);

UPDATE PRODUCTS
SET STOCK = 300
WHERE	PNO = 1007 ;


SELECT 	O.ORDERDATE,C.CNAME, O.ADDRESS,O.PHONE,O.STATUS,P.PNAME, D.COST , D.QTY ,D.COST*D.QTY AS "COST*QTY"
FROM 	ORDERDETAIL D 
JOIN	PRODUCTS P ON(P.PNO = D.PNO)
JOIN	ORDERS O ON(D.ORDERNO = O.ORDERNO)
JOIN	CUSTOMERS C ON(O.CNO = C.CNO);


