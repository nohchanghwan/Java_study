DROP TABLE WALLET CASCADE CONSTRAINT;
DROP TABLE VM CASCADE CONSTRAINT;
DROP TABLE USER_BC CASCADE CONSTRAINT;
DROP TABLE RESULT CASCADE CONSTRAINT;
drop sequence WALLET_IDX;  


CREATE TABLE USER_BC(
      USER_ID   VARCHAR2(30) PRIMARY KEY,
      PWD         VARCHAR2(30) NOT NULL,
      EMAIL      VARCHAR2(50) NOT NULL,
      DEPOSIT   NUMBER(20)    DEFAULT 0
      );
CREATE TABLE VM(
   VM_IDX         NUMBER(10) PRIMARY KEY,
   VM_P            NUMBER(10) NOT NULL
);
      
CREATE TABLE WALLET(
      WALLET_IDX   NUMBER(20) PRIMARY KEY,
      VM_IDX         NUMBER(20) NOT NULL REFERENCES VM(VM_IDX),
      PRICE         NUMBER(20) NOT NULL,
      AMOUNT         NUMBER(20) NOT NULL,
      SUM            NUMBER(20) NOT NULL,
      USER_ID      VARCHAR(30) NOT NULL REFERENCES USER_BC(USER_ID)       
      );
create sequence WALLET_IDX start with 1 increment BY 1;      

CREATE TABLE RESULT(
      USER_ID         VARCHAR2(30)  REFERENCES USER_BC(USER_ID), 
      AMOUNT_SUM      NUMBER(20) DEFAULT 0,
      PRE_VAL         NUMBER(20) DEFAULT 0,
      C_VAL            NUMBER(20) DEFAULT 0,
      RATE               NUMBER(20) DEFAULT 0, 
      WALLET_IDX      NUMBER(20)  REFERENCES WALLET(WALLET_IDX),
      PRIMARY KEY(USER_ID)
      );
INSERT INTO VM VALUES (0,50);

SELECT  USER_ID , deposit , C_VAL, RATE
      FROM   USER_BC
      JOIN    RESULT USING(USER_ID)
      WHERE    USER_ID = 'admin' ;
select * from user_bc
